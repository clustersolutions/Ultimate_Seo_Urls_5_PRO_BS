<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<title>Installation osCommerce version 2.3 - ULTIMATE Seo Urls 5 PRO by FWR Media</title>
<link rel="stylesheet" type="text/css" href="../includes/style.css" />
</head>
<body>
<div id="container">
  <div id="header">
    <img style="padding: 0.6em; float: right;" src="../includes/fwrlogo.png" width="73" height="73" alt="FWR Media" />
    <span style="padding: 0.5em 0.5em 0.5em 1.5em; position: relative;  top: 1.6em;"><span id="fwrTitle1">Ultimate Seo Urls</span><span style="color: red; font-size: 24pt;"> 5</span><span id="fwrTitle2"> PRO</span><br /><span style="font-family: verdana; font-size: xx-small; color: #fff; padding-left: 3em; font-weight: bold;">Version 1.1.0</span></span>
  </div>
  <div id="inner_container">
    <h1>Installation to OsCommerce version 2.3-BS. Updated by Clustersolutions 05-05-2015.</h1>
    <p>7 simple stages only - should take only a few minutes.</p>
    <p><strong>Note:</strong> A lot of effort has gone into ensuring the code parts are space perfect .. 
    this means that if you have an editor that allows multiline searches you can copy the code in this file ( the light green segments ) 
    and should be able to match the entire segment if the code is unchanged from osCommerce original. You can then just paste the new code over the top.</p>
    <h3>1) Uploads directory</h3>
    <p>Upload the files and directories in the "uploads" directory to your server maintaining the directory structure of osCommerce.</p>
    <p>Please note that "catalog" refers to the root of your osCommerce install and probably won't actually exist.</p>
    <p>These are all new files so will not affect your osCommerce installation.</p>
    <p><strong>Important: </strong> now ensure that the following two directories are writable. Dependent on your server this may be 0755 or 0777.</p>
    <ul>
      <li>catalog/includes/modules/ultimate_seo_urls5/cache_system/cache/</li>
      <li>catalog/includes/modules/ultimate_seo_urls5/cache_system/sqlite/</li>
    </ul>
    <p>Now upload the files in additional_uploads/version2.3/ again .. maintaining the osCommerce directory structure.</p>
    <h3>2) catalog/index.php</h3>
    <p>Find ( this is within a block of code ) ...</p>
    <code><span style="color: #000000"><span style="color: #0000BB">tep_draw_form</span><span style="color: #007700">(</span><span style="color: #DD0000">'filter'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">FILENAME_DEFAULT</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'get'</span><span style="color: #007700">)</span></span></code>
    <p>Replace with ...</p>
    <code><span style="color: #000000"><span style="color: #0000BB">tep_draw_form</span><span style="color: #007700">(</span><span style="color: #DD0000">'filter'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">tep_href_link</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">FILENAME_DEFAULT&nbsp;</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">'get'</span><span style="color: #007700">)</span></span></code>
    <h3>3) catalog/includes/functions/html_output.php</h3>
    <p>Find  ( complete function ) ...</p>
    <code><span style="color: #000000"><span style="color: #FF8000">////<br />//&nbsp;The&nbsp;HTML&nbsp;href&nbsp;link&nbsp;wrapper&nbsp;function<br />&nbsp;&nbsp;</span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">tep_href_link</span><span style="color: #007700">(</span><span style="color: #0000BB">$page&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$parameters&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$connection&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'NONSSL'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$add_session_id&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$search_engine_safe&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$request_type</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$session_started</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$SID</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$page&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">tep_output_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$page</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #0000BB">tep_not_null</span><span style="color: #007700">(</span><span style="color: #0000BB">$page</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die(</span><span style="color: #DD0000">'&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&lt;font&nbsp;color="#ff0000"&gt;&lt;strong&gt;Error!&lt;/strong&gt;&lt;/font&gt;&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&lt;strong&gt;Unable&nbsp;to&nbsp;determine&nbsp;the&nbsp;page&nbsp;link!&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;'</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$connection&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">'NONSSL'</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$link&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">HTTP_SERVER&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">DIR_WS_HTTP_CATALOG</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;elseif&nbsp;(</span><span style="color: #0000BB">$connection&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">'SSL'</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">ENABLE_SSL&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$link&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">HTTPS_SERVER&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">DIR_WS_HTTPS_CATALOG</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$link&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">HTTP_SERVER&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">DIR_WS_HTTP_CATALOG</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die(</span><span style="color: #DD0000">'&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&lt;font&nbsp;color="#ff0000"&gt;&lt;strong&gt;Error!&lt;/strong&gt;&lt;/font&gt;&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&lt;strong&gt;Unable&nbsp;to&nbsp;determine&nbsp;connection&nbsp;method&nbsp;on&nbsp;a&nbsp;link!&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;Known&nbsp;methods:&nbsp;NONSSL&nbsp;SSL&lt;/strong&gt;&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;'</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">tep_not_null</span><span style="color: #007700">(</span><span style="color: #0000BB">$parameters</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$link&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #0000BB">$page&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'?'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">tep_output_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$parameters</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$separator&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'&amp;'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$link&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #0000BB">$page</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$separator&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'?'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(&nbsp;(</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">,&nbsp;-</span><span style="color: #0000BB">1</span><span style="color: #007700">)&nbsp;==&nbsp;</span><span style="color: #DD0000">'&amp;'</span><span style="color: #007700">)&nbsp;||&nbsp;(</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">,&nbsp;-</span><span style="color: #0000BB">1</span><span style="color: #007700">)&nbsp;==&nbsp;</span><span style="color: #DD0000">'?'</span><span style="color: #007700">)&nbsp;)&nbsp;</span><span style="color: #0000BB">$link&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;-</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Add&nbsp;the&nbsp;session&nbsp;ID&nbsp;when&nbsp;moving&nbsp;from&nbsp;different&nbsp;HTTP&nbsp;and&nbsp;HTTPS&nbsp;servers,&nbsp;or&nbsp;when&nbsp;SID&nbsp;is&nbsp;defined<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(&nbsp;(</span><span style="color: #0000BB">$add_session_id&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">)&nbsp;&amp;&amp;&nbsp;(</span><span style="color: #0000BB">$session_started&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">)&nbsp;&amp;&amp;&nbsp;(</span><span style="color: #0000BB">SESSION_FORCE_COOKIE_USE&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">'False'</span><span style="color: #007700">)&nbsp;)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">tep_not_null</span><span style="color: #007700">(</span><span style="color: #0000BB">$SID</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_sid&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$SID</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;elseif&nbsp;(&nbsp;(&nbsp;(</span><span style="color: #0000BB">$request_type&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">'NONSSL'</span><span style="color: #007700">)&nbsp;&amp;&amp;&nbsp;(</span><span style="color: #0000BB">$connection&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">'SSL'</span><span style="color: #007700">)&nbsp;&amp;&amp;&nbsp;(</span><span style="color: #0000BB">ENABLE_SSL&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">)&nbsp;)&nbsp;||&nbsp;(&nbsp;(</span><span style="color: #0000BB">$request_type&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">'SSL'</span><span style="color: #007700">)&nbsp;&amp;&amp;&nbsp;(</span><span style="color: #0000BB">$connection&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">'NONSSL'</span><span style="color: #007700">)&nbsp;)&nbsp;)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">HTTP_COOKIE_DOMAIN&nbsp;</span><span style="color: #007700">!=&nbsp;</span><span style="color: #0000BB">HTTPS_COOKIE_DOMAIN</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_sid&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">tep_session_name</span><span style="color: #007700">()&nbsp;.&nbsp;</span><span style="color: #DD0000">'='&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">tep_session_id</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(isset(</span><span style="color: #0000BB">$_sid</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$link&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #0000BB">$separator&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">tep_output_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$_sid</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(</span><span style="color: #0000BB">strstr</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&amp;&amp;'</span><span style="color: #007700">))&nbsp;</span><span style="color: #0000BB">$link&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'&amp;&amp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&amp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$link</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;(</span><span style="color: #0000BB">SEARCH_ENGINE_FRIENDLY_URLS&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">'true'</span><span style="color: #007700">)&nbsp;&amp;&amp;&nbsp;(</span><span style="color: #0000BB">$search_engine_safe&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">)&nbsp;)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$link&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'?'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'/'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$link</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$link&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'&amp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'/'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$link</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$link&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'='</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'/'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$link</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$link&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'&amp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&amp;amp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$link</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$link</span><span style="color: #007700">;<br />&nbsp;&nbsp;}</span></span></code>
    <p>Replace with ...</p>
    <code><span style="color: #000000">&nbsp;&nbsp;<span style="color: #FF8000">/**<br />&nbsp;&nbsp;*&nbsp;ULTIMATE&nbsp;Seo&nbsp;Urls&nbsp;5&nbsp;PRO&nbsp;by&nbsp;FWR&nbsp;Media<br />&nbsp;&nbsp;*&nbsp;Replacement&nbsp;for&nbsp;osCommerce&nbsp;href&nbsp;link&nbsp;wrapper&nbsp;function<br />&nbsp;&nbsp;*/<br />&nbsp;&nbsp;</span><span style="color: #007700">require_once&nbsp;</span><span style="color: #0000BB">DIR_WS_MODULES&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'ultimate_seo_urls5/main/usu5.php'</span><span style="color: #007700">;<br />&nbsp;&nbsp;<br />&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">tep_href_link</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$page&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$parameters&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$connection&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'NONSSL'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$add_session_id&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$search_engine_safe&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">true&nbsp;</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">Usu_Main</span><span style="color: #007700">::</span><span style="color: #0000BB">i</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">hrefLink</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$page</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$parameters</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$connection</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$add_session_id</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$search_engine_safe&nbsp;</span><span style="color: #007700">);<br />&nbsp;&nbsp;}</span></span></code>
    <h3>4) catalog/includes/application_top.php</h3>
    <p>Find ...</p>
    <code><span style="color: #000000"><span style="color: #FF8000">//&nbsp;set&nbsp;php_self&nbsp;in&nbsp;the&nbsp;local&nbsp;scope<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$req</span>&nbsp;<span style="color: #007700">=</span>&nbsp;<span style="color: #0000BB">parse_url</span><span style="color: #007700">(</span><span style="color: #0000BB">$HTTP_SERVER_VARS</span><span style="color: #007700">[</span><span style="color: #DD0000">'SCRIPT_NAME'</span><span style="color: #007700">]);</span><br />&nbsp;&nbsp;<span style="color: #0000BB">$PHP_SELF&nbsp;</span><span style="color: #007700">=</span>&nbsp;<span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$req</span><span style="color: #007700">[</span><span style="color: #DD0000">'path'</span><span style="color: #007700">],&nbsp;(</span><span style="color: #0000BB">$request_type</span>&nbsp;<span style="color: #007700">==</span>&nbsp;<span style="color: #DD0000">'NONSSL'</span><span style="color: #007700">)&nbsp;?</span>&nbsp;<span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">DIR_WS_HTTP_CATALOG</span><span style="color: #007700">)&nbsp;:</span>&nbsp;<span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">DIR_WS_HTTPS_CATALOG</span><span style="color: #007700">));</span></span></code>
    <p>Replace with ...</p>
    <code><span style="color: #000000"><span style="color: #FF8000">/**<br />&nbsp;&nbsp;*&nbsp;ULTIMATE&nbsp;Seo&nbsp;Urls&nbsp;5&nbsp;PRO&nbsp;by&nbsp;FWR&nbsp;Media<br />&nbsp;&nbsp;*&nbsp;function&nbsp;to&nbsp;return&nbsp;the&nbsp;base&nbsp;filename&nbsp;<br />&nbsp;&nbsp;*/<br />&nbsp;&nbsp;</span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">usu5_base_filename</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Probably&nbsp;won't&nbsp;get&nbsp;past&nbsp;SCRIPT_NAME&nbsp;unless&nbsp;this&nbsp;is&nbsp;reporting&nbsp;cgi&nbsp;location<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$base&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">ArrayIterator</span><span style="color: #007700">(&nbsp;array(&nbsp;</span><span style="color: #DD0000">'SCRIPT_NAME'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'PHP_SELF'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'REQUEST_URI'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'ORIG_PATH_INFO'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'HTTP_X_ORIGINAL_URL'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'HTTP_X_REWRITE_URL'&nbsp;</span><span style="color: #007700">)&nbsp;);<br />&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(&nbsp;</span><span style="color: #0000BB">$base</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">valid</span><span style="color: #007700">()&nbsp;)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;</span><span style="color: #0000BB">array_key_exists</span><span style="color: #007700">(&nbsp;&nbsp;</span><span style="color: #0000BB">$base</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">current</span><span style="color: #007700">(),&nbsp;</span><span style="color: #0000BB">$_SERVER&nbsp;</span><span style="color: #007700">)&nbsp;&amp;&amp;&nbsp;!empty(&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #0000BB">$base</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">current</span><span style="color: #007700">()]&nbsp;)&nbsp;)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;</span><span style="color: #0000BB">false&nbsp;</span><span style="color: #007700">!==&nbsp;</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #0000BB">$base</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">current</span><span style="color: #007700">()],&nbsp;</span><span style="color: #DD0000">'.php'&nbsp;</span><span style="color: #007700">)&nbsp;)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">'@[a-z0-9_]+\.php@i'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #0000BB">$base</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">current</span><span style="color: #007700">()],&nbsp;</span><span style="color: #0000BB">$matches&nbsp;</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;</span><span style="color: #0000BB">is_array</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$matches&nbsp;</span><span style="color: #007700">)&nbsp;&amp;&amp;&nbsp;(&nbsp;</span><span style="color: #0000BB">array_key_exists</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$matches&nbsp;</span><span style="color: #007700">)&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;(&nbsp;</span><span style="color: #0000BB">substr</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$matches</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">],&nbsp;-</span><span style="color: #0000BB">4</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">4&nbsp;</span><span style="color: #007700">)&nbsp;==&nbsp;</span><span style="color: #DD0000">'.php'&nbsp;</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;(&nbsp;</span><span style="color: #0000BB">is_readable</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$matches</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]&nbsp;)&nbsp;)&nbsp;)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$matches</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$base</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">next</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Some&nbsp;odd&nbsp;server&nbsp;set&nbsp;ups&nbsp;return&nbsp;/&nbsp;for&nbsp;SCRIPT_NAME&nbsp;and&nbsp;PHP_SELF&nbsp;when&nbsp;accessed&nbsp;as&nbsp;mysite.com&nbsp;(no&nbsp;index.php)&nbsp;where&nbsp;they&nbsp;usually&nbsp;return&nbsp;/index.php<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(&nbsp;(&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'SCRIPT_NAME'</span><span style="color: #007700">]&nbsp;==&nbsp;</span><span style="color: #DD0000">'/'&nbsp;</span><span style="color: #007700">)&nbsp;||&nbsp;(&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'PHP_SELF'</span><span style="color: #007700">]&nbsp;==&nbsp;</span><span style="color: #DD0000">'/'&nbsp;</span><span style="color: #007700">)&nbsp;)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #DD0000">'index.php'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Return&nbsp;the&nbsp;standard&nbsp;RC3&nbsp;code&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;(&nbsp;(&nbsp;(&nbsp;</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">ini_get</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">'cgi.fix_pathinfo'&nbsp;</span><span style="color: #007700">)&nbsp;)&nbsp;&gt;&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">)&nbsp;&amp;&amp;&nbsp;(&nbsp;(bool)</span><span style="color: #0000BB">ini_get</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">'cgi.fix_pathinfo'&nbsp;</span><span style="color: #007700">)&nbsp;==&nbsp;</span><span style="color: #0000BB">false&nbsp;</span><span style="color: #007700">)&nbsp;)&nbsp;||&nbsp;!isset(&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'SCRIPT_NAME'</span><span style="color: #007700">]&nbsp;)&nbsp;)&nbsp;?&nbsp;</span><span style="color: #0000BB">basename</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'PHP_SELF'</span><span style="color: #007700">]&nbsp;)&nbsp;:&nbsp;</span><span style="color: #0000BB">basename</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'SCRIPT_NAME'</span><span style="color: #007700">]&nbsp;);<br />&nbsp;&nbsp;}&nbsp;</span><span style="color: #FF8000">//&nbsp;End&nbsp;function<br />//&nbsp;set&nbsp;php_self&nbsp;in&nbsp;the&nbsp;local&nbsp;scope<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$PHP_SELF&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">usu5_base_filename</span><span style="color: #007700">();</span></span></code>
    <p>Find ...</p>
    <code><span style="color: #000000">
    <span style="color: #FF8000">//&nbsp;include&nbsp;the&nbsp;language&nbsp;translations
    <br />&nbsp;&nbsp;</span><span style="color: #007700">require(</span><span style="color: #0000BB">DIR_WS_LANGUAGES&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$language&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'.php'</span><span style="color: #007700">);</span></span></code>
    <p>Add immediately <strong>ABOVE</strong> ...</p>
    <code><span style="color: #000000"><span style="color: #0000BB">&nbsp;&nbsp;</span><span style="color: #FF8000">/**<br />&nbsp;&nbsp;*&nbsp;ULTIMATE&nbsp;Seo&nbsp;Urls&nbsp;5&nbsp;PRO&nbsp;by&nbsp;FWR&nbsp;Media<br />&nbsp;&nbsp;*/<br />&nbsp;&nbsp;</span><span style="color: #0000BB">Usu_Main</span><span style="color: #007700">::</span><span style="color: #0000BB">i</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">setVar</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">'languages_id'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$languages_id&nbsp;</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">setVar</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">'request_type'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$request_type&nbsp;</span><span style="color: #007700">)&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">setVar</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">'session_started'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$session_started&nbsp;</span><span style="color: #007700">)&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">setVar</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">'sid'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$SID&nbsp;</span><span style="color: #007700">)&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">setVar</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">'language'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$language&nbsp;</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">setVar</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">'filename'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$PHP_SELF&nbsp;</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">initiate</span><span style="color: #007700">(&nbsp;(&nbsp;isset(&nbsp;</span><span style="color: #0000BB">$lng&nbsp;</span><span style="color: #007700">)&nbsp;&amp;&amp;&nbsp;(&nbsp;</span><span style="color: #0000BB">$lng&nbsp;</span><span style="color: #007700">instanceof&nbsp;</span><span style="color: #0000BB">language&nbsp;</span><span style="color: #007700">)&nbsp;)&nbsp;?&nbsp;</span><span style="color: #0000BB">$lng&nbsp;</span><span style="color: #007700">:&nbsp;array(),&nbsp;</span><span style="color: #0000BB">$languages_id</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$language&nbsp;</span><span style="color: #007700">);</span></span></code>
    <h3>5) catalog/includes/modules/product_listing.php</h3>
    <p> Find ( in the long line search for action=buy_now ): ...</p>
    <code><span style="color: #000000"><span style="color: #0000BB">tep_href_link</span><span style="color: #007700">(</span><span style="color: #0000BB">basename</span><span style="color: #007700">(</span><span style="color: #0000BB">$PHP_SELF</span><span style="color: #007700">),&nbsp;</span><span style="color: #0000BB">tep_get_all_get_params</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'action'</span><span style="color: #007700">,</span>&nbsp;<span style="color: #DD0000">'sort'</span><span style="color: #007700">,</span>&nbsp;<span style="color: #DD0000">'cPath'</span><span style="color: #007700">))&nbsp;.&nbsp;</span><span style="color: #DD0000">'action=buy_now&amp;products_id='&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$listing</span><span style="color: #007700">[</span><span style="color: #DD0000">'products_id'</span><span style="color: #007700">])</span></span></code>
    <p>Replace with ...</p>
    <code><span style="color: #000000"><span style="color: #0000BB">tep_href_link</span><span style="color: #007700">(</span><span style="color: #0000BB">basename</span><span style="color: #007700">(</span><span style="color: #0000BB">$PHP_SELF</span><span style="color: #007700">),&nbsp;</span><span style="color: #0000BB">tep_get_all_get_params</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'action'</span><span style="color: #007700">,</span>&nbsp;<span style="color: #DD0000">'sort'</span><span style="color: #007700">,</span>&nbsp;<span style="color: #DD0000">'cPath'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'products_id'</span><span style="color: #007700">))&nbsp;.&nbsp;</span><span style="color: #DD0000">'action=buy_now&amp;products_id='&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$listing</span><span style="color: #007700">[</span><span style="color: #DD0000">'products_id'</span><span style="color: #007700">])</span></span></code>
    <p><strong>Note:</strong> Don't worry if you can't find the above, if you have a modified file the code may not exist</p>
    <h3>6) catalog/<b style="color: red;">ADMIN</b>/categories.php</h3>
    <p>Find ...</p>
    <code><span style="color: #000000">
    <span style="color: #007700">&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">tep_not_null</span><span style="color: #007700">(</span><span style="color: #0000BB">$action</span><span style="color: #007700">))&nbsp;{</span></span></code>
    <p>Replace with ...</p>
    <code><span style="color: #000000">&nbsp;&nbsp;<span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">tep_not_null</span><span style="color: #007700">(</span><span style="color: #0000BB">$action</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;ULTIMATE&nbsp;Seo&nbsp;Urls&nbsp;5&nbsp;PRO&nbsp;by&nbsp;FWR&nbsp;Media<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;If&nbsp;the&nbsp;action&nbsp;will&nbsp;affect&nbsp;the&nbsp;cache&nbsp;entries<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(&nbsp;</span><span style="color: #0000BB">$action&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">'insert'&nbsp;</span><span style="color: #007700">||&nbsp;</span><span style="color: #0000BB">$action&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">'update'&nbsp;</span><span style="color: #007700">||&nbsp;</span><span style="color: #0000BB">$action&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">'setflag'&nbsp;</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">tep_reset_cache_data_usu5</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">'reset'&nbsp;</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></code>
    <h3>7) catalog/<b style="color: red;">ADMIN</b>/includes/functions/general.php</h3>
    <p>At the very bottom of the file immediately above the very final ?&gt; .. add .. </p>
    <code><span style="color: #000000"><span style="color: #0000BB">&nbsp;&nbsp;</span><span style="color: #FF8000">/**<br />&nbsp;&nbsp;*&nbsp;ULTIMATE&nbsp;Seo&nbsp;Urls&nbsp;5&nbsp;PRO&nbsp;by&nbsp;FWR&nbsp;Media<br />&nbsp;&nbsp;*&nbsp;Reset&nbsp;the&nbsp;various&nbsp;cache&nbsp;systems<br />&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$action<br />&nbsp;&nbsp;*/<br />&nbsp;&nbsp;</span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">tep_reset_cache_data_usu5</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$action&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">false&nbsp;</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;</span><span style="color: #0000BB">$action&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">'reset'&nbsp;</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$usu5_path&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">realpath</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">dirname</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">__FILE__&nbsp;</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">'/../../../'&nbsp;</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">'/'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">DIR_WS_MODULES&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'ultimate_seo_urls5/'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch(&nbsp;</span><span style="color: #0000BB">USU5_CACHE_SYSTEM&nbsp;</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;</span><span style="color: #DD0000">'file'</span><span style="color: #007700">:&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$path_to_cache&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$usu5_path&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'cache_system/cache/'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$it&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">DirectoryIterator</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$path_to_cache&nbsp;</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(&nbsp;</span><span style="color: #0000BB">$it</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">valid</span><span style="color: #007700">()&nbsp;)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;!</span><span style="color: #0000BB">$it</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">isDot</span><span style="color: #007700">()&nbsp;&amp;&amp;&nbsp;</span><span style="color: #0000BB">is_readable</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$path_to_cache&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$it</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getFilename</span><span style="color: #007700">()&nbsp;)&nbsp;&amp;&amp;&nbsp;(&nbsp;</span><span style="color: #0000BB">substr</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$it</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getFilename</span><span style="color: #007700">(),&nbsp;-</span><span style="color: #0000BB">6&nbsp;</span><span style="color: #007700">)&nbsp;==&nbsp;</span><span style="color: #DD0000">'.cache'&nbsp;</span><span style="color: #007700">)&nbsp;)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span style="color: #0000BB">unlink</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$path_to_cache&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$it</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getFilename</span><span style="color: #007700">()&nbsp;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$it</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">next</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;</span><span style="color: #DD0000">'mysql'</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">tep_db_query</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">'TRUNCATE&nbsp;TABLE&nbsp;`usu_cache`'&nbsp;</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;</span><span style="color: #DD0000">'memcache'</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;</span><span style="color: #0000BB">class_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">'Memcache'</span><span style="color: #007700">)&nbsp;){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include&nbsp;</span><span style="color: #0000BB">$usu5_path&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'interfaces/cache_interface.php'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include&nbsp;</span><span style="color: #0000BB">$usu5_path&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'cache_system/memcache.php'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">Memcache_Cache_Module</span><span style="color: #007700">::</span><span style="color: #0000BB">iAdmin</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">initiate</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">flushOut</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;</span><span style="color: #DD0000">'sqlite'</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include&nbsp;</span><span style="color: #0000BB">$usu5_path&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'interfaces/cache_interface.php'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include&nbsp;</span><span style="color: #0000BB">$usu5_path&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'cache_system/sqlite.php'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">Sqlite_Cache_Module</span><span style="color: #007700">::</span><span style="color: #0000BB">admini</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">gc</span><span style="color: #007700">();&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">tep_db_query</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">"UPDATE&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">TABLE_CONFIGURATION&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"&nbsp;SET&nbsp;configuration_value='false'&nbsp;WHERE&nbsp;configuration_key='USU5_RESET_CACHE'"&nbsp;</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;}&nbsp;</span><span style="color: #FF8000">//&nbsp;end&nbsp;function</span></span></code>
    <div style="padding: 0.5em;">
    <p>Thank you for donating, it allows us to spend more time developing free contributions for you to use.</p>
      <form action="https://www.paypal.com/cgi-bin/webscr" method="post">
        <input type="hidden" name="cmd" value="_s-xclick" />
        <input type="hidden" name="hosted_button_id" value="L2MKTV24AC7WY" />
        <input type="image" src="https://www.paypal.com/en_GB/i/btn/btn_donate_LG.gif" name="submit" alt="PayPal - The safer, easier way to pay online." />
        <img alt="" border="0" src="https://www.paypal.com/en_GB/i/scr/pixel.gif" width="1" height="1" />
      </form>
    </div>
    <div style="padding: 1em;"><h2>Your installation is now complete!</h2>  please <a href="install_complete.htm">click here</a> (.htaccess setup is necessary for URL rewrite and also maintaining compatabiity with Chemo's SEO URL version)</div>
    <div style="padding: 0.5em;"></div>   
    <div id="fwrfooter"><a href="http://www.fwrmedia.co.uk" title="PHP - MySQL - osCommerce by FWR Media"> ... another script by FWR Media</a></div>
  </div>
</div>
</body>
</html>
